\documentclass{llncs}

%%%%%%%%%%%%%%%%%%%
%%% Packages
%%%%%%%%%%%%%%%%%%%
\usepackage[backend=biber, style=lncs]{biblatex}
\addbibresource{ref.bib}
% !TEX TS-program = pdflatexmk

\usepackage{geometry}
\geometry{
  a4paper,         % or letterpaper
  textwidth=15cm,  % llncs has 12.2cm
  textheight=24cm, % llncs has 19.3cm
  hratio=1:1,      % horizontally centered
  vratio=2:3,      % not vertically centered
}

\usepackage[table]{xcolor}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{nicefrac}
\usepackage{hhline}
\usepackage{bigdelim}
\usepackage{booktabs}

\usepackage{float}
\usepackage{tcolorbox}
\tcbuselibrary{theorems}

\newtcbtheorem{tcbexample}{Example}{
  boxrule=0.15mm,
  colback=gray!15,
  colbacktitle=gray!15,
  coltitle=red!50!black,
  fonttitle=\bfseries,
  detach title,
  before upper={\tcbtitle},
  separator sign none,
  description delimiters={(}{). }
}{ex}

\usepackage{tikz}
\usetikzlibrary{quantikz2}

\newcommand{\ketbra}[2]{\ensuremath{| #1 \rangle \langle #2 |}}
\newcommand{\ci}{\mathrm{i}}
\DeclarePairedDelimiter{\card}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}
\DeclareMathOperator{\tr}{tr}

%%%%%%%%%%%%%%%%%%%
%%% General Cmds
%%%%%%%%%%%%%%%%%%%
\newcommand{\todo}[1]{{\color{red}\bfseries{}TODO: #1}}
  
\begin{document}
\title{Quantum Pseudo-Telepathy}
\subtitle{The Magic Square Game}

\author{Luigi Soares \and Roberto Rosmaninho}
\institute{%
  Department of Computer Science, UFMG - Brazil \\
  \email{\{luigi.domenico, robertogomes\}@dcc.ufmg.br}}

\maketitle
% \begin{abstract}
% \end{abstract}

\section{Introduction}
\label{sec:intro}

Telepathy, the ability of transmitting information from one
person's mind to another's, would certainly come in handy in
many situations, right? Unfortunately (or not), (to the best
of our knowledge) telepathy is not a thing. At least, not
according to classical physics. Certain aspects of the
quantum realm, however, provide a way of communication that
for a layman looks as magical as ``true'' telepathy. This
phenomenon is called quantum
\emph{pseudo-telepathy}~\cite{brassard:2005}.


Quantum pseudo-telepathy is observed in many contexts,
usually described in the format of a game: the ``impossible
colouring games''~\cite{brassard:2005, Kochen1975}; the
parity games, in which \(n \geq 3\) players are given
bit-strings and, without communicating to each other, they
output one of their bits, winning if their outputs combined
obey certain parity conditions~\cite{brassard:2005,
  Mermin1990}; the Deutsch-Jozsa games, where Alice and Bob
are given bit strings \(x\) and \(y\), and must output bit
strings \(a\) and \(b\) such that \(a = b\) if and only if
\(x = y\)~\cite{brassard:2005, Brassard_1999}; and, the
Magic Square game~\cite{brassard:2005, Mermin1990}. None of
these games admit a classical winning strategy (i.e.\ is not
possible to always win), yet they can be won systematically,
without any communication, provided that the players share
prior entanglement~\cite{brassard:2005}.

In this project, we shall explore the Mermin-Peres Magic Square game
(hereinafter referred simply as Magic Square). The origins of this
game date back to the ninities. It was first described ---~albeit not
in the format of a game~--- in the works of Mermin~\cite{mermin:1990}
and of Peres~\cite{peres:1990}. Their results provided (as per the
title of Mermin's review letter) a simplied proof for the
Kochen-Specker theorem~\cite{Kocher1975}. Later, in 2002, Aravind
demonstrated how to transform Mermin-Peres's proof of then
Kochen-Specker theorem into a proof of Bell's
theorem~\cite{aravind:xxx}. Bell's theorem shows the incompatibility
of hidden variables (i.e. determinism) and locality, whereas
Kochen-Specker's theorem demonstrates the conflicting nature of
determinism and non-contextuality.  These sort of results may seem
challenging, but their descriptions can be greatly simplified by
modeling them as quantum games.  In particular, it is extremely easy
to show that there cannot be a classical solution to the the Magic
Square game, and to convince an observer that something ``magical''
(classically impossible) is happening in a successful implementation
of a quantum winnin strategy~\cite{brassard:2005}.

\todo{FIX: they talk about contextuality only (both theorems)}

\paragraph{Outline of this paper.}

\section{The Magic Square Game}
\label{sec:magic-square}

A magic square is a \(3 \times 3\) matrix whose entries are filled
with \(\pm 1\)'s. The product of every row of a magic square must be
\(+1\). Similarly, the product of every column of a magic square must
be \(-1\). Is impossible to satisfy these two properties at the same
time, hence the term \emph{magic}: such a matrix cannot exist. The
Magic Square game features two players, Alice and Bob, that must work
together to fill in entries of the \(3 \times 3\) table.  At the
beginning of the game, Alice and Bob are separated by a referee,
Charlie, so that communication between them is impossible. At each
round, Charlie assigns one row of the matrix at random to Alice, and
asks Alice to give him the entries to fill in that particular
row. After that, Charlie visits Bob and asks him to fill one column of
the table, which Charlie draws at random.  Bob does not know which row
Alice was assigned, and Alice does not know which colum Bob was
assigned. Alice and Bob win the round if their answers are valid,
i.e.\ the product of the row filled by Alice is \(+1\) and the product
of the column filled by Bob is \(-1\), and, in addition, the
intersection of the row and the column agrees (i.e. both answered
\(+1\) or both answered \(-1\)). Before the game starts, Alice and Bob
are allowed to communicate, so they can come up with an strategy.  For
example, they may prepare their answers for each row and column
beforehand, or they may decide to follow a probabilistic strategy.

\subsection{Classical Solution}
\label{sec:classic-sol}
Assume that Alice and Bob decided to adopt a deterministic strategy.
For that, they met before the beginning of the game, and prepared
their answers for each possible row and column. In this scenario,
what is the best strategy that they can come up with?

\begin{tcbexample}{Classical, Deterministic Solution}{classic-sol}
  Alice and Bob might have agreed that, if given the first column, Bob shall fill it
  with three \(-1\)'s. Then, whatever row Alice is given, she must fill
  it with either \(\{-1, +1, -1\}\) or \(\{-1, -1, +1\}\). Suppose that
  Alice decided that she would fill any row in the same way:
  \(\{-1, -1, +1\}\). Figure~\ref{fig:classical} (a) shows how the
  predefined matrix would look like. Notice that Alice's rows are
  already defined, but Bob still has to decide how to fill the second
  and third columns. He can, and must, fill the second column with three
  \(-1\)'s, so that whatever row Alice is given, the intersection
  agrees. Intuitively, for the same reason, he should then fill the
  third column with three \(+1\)'s. However, this is not a valid
  strategy, since the product of the last column will be \(+1\) and not
  \(-1\), as required. Thus, Bob must fill at least one of the
  entries of the last column with \(-1\).  By doing that, there will be
  one row and column whose intersection does not agree, and thus one row
  and column for which Alice and Bob lose, as illustrated in
  Figure~\ref{fig:classical} (b).

  {\renewcommand{\arraystretch}{2}
    \begin{figure}[H]
      \centering
      \begin{subfigure}[t]{0.475\textwidth}
        \[\begin{array}{|>{\quad\columncolor{gray!50}}c<{\quad}|*{2}{>{\quad}c<{\quad}|}}
            \hhline{---}
            -1 & -1 & +1 
            \\ \hhline{---}
            -1 & -1 & +1 
            \\ \hhline{---}
            -1 & -1 & +1 
            \\ \hhline{---}
          \end{array}\]
        \caption{Initially, Alice and Bob agree that Bob shall fill the
          first column with \(\{-1, -1, -1\}\). Based on this choice,
          Alice decides to fill all of her rows with
          \(\{-1, -1, +1\}\).}
      \end{subfigure}
      \hfill{}
      \begin{subfigure}[t]{0.475\textwidth}
        \[\begin{array}{|*{3}{>{\quad\columncolor{gray!50}}c<{\quad}|}}
            \hhline{---}
            -1 & -1 & \cellcolor{red!80!black!55}\pm 1
            \\ \hhline{---}
            -1 & -1 & +1
            \\ \hhline{---}
            -1 & -1 & +1
            \\ \hhline{---}
          \end{array}\]
        \caption{Bob has to fill the second column with \(-1\)'s, to match
          Alice's choice. He should also match Alice's choice for each
          cell of the third column, but he cannot, for the product of
          the column must be \(-1\).}
      \end{subfigure}
      \caption{One possible classical deterministic strategy for the Magic
        Square game. Following this predefined strategy, Alice and Bob
        lose when assigned, respectively, the first row and third column,
        but win in any other scenario. That is, their probability of
        winning a round is \(\nicefrac{8}{9}\). Gray cells are entries for
        which Alice's and Bob's choices agree.\label{fig:classical}}
    \end{figure}}
\end{tcbexample}

Example~\ref{ex:classic-sol} illustrates one of the many deterministic
strategies that Alice and Bob can adopt. It is not difficult to
convince yourself that, no matter how they decide to fill in
their entries, it is impossible for them to come up with predefined
answers that always win. Any deterministic strategy is a pair of
matrices, one for Alice and another for Bob. The only way that they could
design a strategy that wins with certainty every round is to prepare two
identical matrices satisfying the requirements for each row and for each
column. That is, a single matrix for which the product of every row is
\(+1\) and the product of every column is \(-1\). Such a matrix cannot
possibly exist! It turns out that the best that they can do is to win
with probability \(\nicefrac{8}{9}\).

What if Alice and Bob decide for a probabilistic strategy? That is, Alice and
Bob each carry a coin. When assigned a row/column, they flip their
coins and fill the entries of the row/column based on the outcomes of
the coins. Can they do better? To randomly assign values to one row
(equivalently, one column) is essentially the same as randomly
selecting one of the \(2^{9}\) possible predefined \(3 \times 3\)
grids (including those matrices that would lead to invalid
answers). In other words, a probabilistic strategy for the Magic
Square game is one in which Alice and Bob randomly select a
deterministic strategy. Hence, no matter how lucky Alice and Bob are,
the probability of success of any strategy that they come up with is
bounded by the winning probability of the best deterministic strategy,
which is \(\nicefrac{8}{9}\). Theorem~\ref{thm:classical-success}
formalizes this argument.

\subsection{Quantum Solution}
\label{sec:quantum-sol}
The quantum strategy for the Magic Square game consists of Alice and
Bob carrying entangled qubits with them. For each round, they need a
pair of qubits each. Then, when Charlie asks Alice (respectively Bob)
to fill the entries of the \(i\)-th row (respectively \(j\)-th
column), Alice measures her two qubits three times. The outcome of
each measurement gives the value for each cell (in practice, they do
not even need the third measurement, since they can determine the third
value from the first two). Key to this strategy is that the outcomes
of all possible measurements are \(\pm 1\). The initial, entangled state
is (subscripts \(A\) and \(B\) indicate, respectively,
Alice's and Bob's qubits)
\begin{equation}
  \ket{\psi} = \frac{1}{2}\left(
    \ket{00}_{A} \otimes \ket{00}_{B} + \ket{01}_{A} \otimes \ket{01}_{B} +
    \ket{10}_{A} \otimes \ket{10}_{B} + \ket{11}_{A} \otimes \ket{11}_{B}
  \right).
\end{equation}
Figure~\ref{fig:circuit-psi} shows the quantum circuit that can be
used to prepare the initial state \(\ket{\psi}\).

\begin{figure}[htbp]
  \centering
  \begin{quantikz}
    \lstick{\ket{0}} & \gate{H}
    \slice[label style={xshift=-15mm}]
    {\(\frac{1}{2}(\ket{00} + \ket{01} + \ket{10} +
      \ket{11}) \otimes \ket{00}\)}
    &&&&& \ctrl{2} &&
    \\
    \lstick{\ket{0}} & \gate{H} &&&&&& \ctrl{2} & \\
    \lstick{\ket{0}} & &&&&& \targ{} && \\
    \lstick{\ket{0}} & &&&&&& \targ{}
    \slice[label style={xshift=5mm}]
    {\(\frac{1}{2}(\ket{0000} + \ket{0101} + \ket{1010} +
      \ket{1111})\)}
    &
  \end{quantikz}
  \caption{\label{fig:circuit-psi}}
\end{figure}

As seen in Section~\ref{sec:classic-sol}, the \emph{magic} square is
called this way because, under classical assumptions, there is no such
a square: it is impossible to construct a \(3 \times 3\) matrix filled
with \(\pm 1\)'s, with the constraints that the product of every row
is \(+1\) and the product of every column is \(-1\). We can, however,
construct a ``quantum magic'' square. Figure~\ref{fig:quantum} shows
the \(3 \times 3\) grid that Alice and Bob can use to win the Magic
Square game systematically.  Notice that the eigenvalues of the
observables at each cell are \(\pm 1\). Furthermore, the product of
every row is \(+I\) and the product of every column is \(-I\).  The
quantum strategy works as follows: Alice measures all the observables
from the \(i\)-th row of the predefined matrix. She fills each cell
with the result of each measurement. Similarly, Bob measures all the
observables in the \(j\)-th column that was assigned to him, and fills
each cell of his column with the outcomes of each
measurement. Example~\ref{ex:quantum-sol} depicts a round of the game.


{\renewcommand{\arraystretch}{2}
\begin{figure}
  \centering
  \[\begin{array}{|*{3}{>{\quad}c<{\quad}|}>{\quad}l<{\quad}}
      \hhline{---~}
      +I \otimes Z & +Z \otimes I & +Z \otimes Z & \prod = I \otimes I = I
      \\ \hhline{---~}
      +X \otimes I & +I \otimes X & +X \otimes X & \prod = I \otimes I = I
      \\ \hhline{---~}
      -X \otimes Z & -Z \otimes X & +Y \otimes Y & \prod = \ci{}I \otimes -\ci{}I = I
      \\ \hhline{---~}
      \multicolumn{1}{>{\quad}c<{\quad}}{\prod = -I \otimes I = -I}
      & \multicolumn{1}{>{\quad}c<{\quad}}{\prod = -I \otimes I = -I}
      & \multicolumn{1}{>{\quad}c<{\quad}}{\prod = -\ci{}I \otimes -\ci{}I = -I}
    \end{array}\]
  \caption{\label{fig:quantum}}
\end{figure}}

\begin{tcbexample}{Quantum Solution}{quantum-sol}
  Suppose that Charlie assigns the first row to Alice. To decide the
  value of the first cell, she (based on the \(3 \times 3\) grid she
  and Bob have prepared) measures the observable \(I \otimes Z\)
  on her two qubits. The possible outcomes are
  \begin{equation}
    \operatorname{Out}((I \otimes Z)_{A} \otimes (I \otimes I)_{B}) =
    \begin{cases}
      +1 \left(I \otimes \ketbra{0}{0} \otimes I \otimes I\right)
        &\text{with probability } \frac{1}{2} \\
      -1 \left(I \otimes \ketbra{1}{1} \otimes I \otimes I\right)
        &\text{with probability } \frac{1}{2},
    \end{cases}
  \end{equation}
  Suppose that Alice has observed \(+1\). In this case, the initial
  state \(\ket{\psi}\) collapses to
  \begin{equation}
    \ket{\psi}_{A1} =  \frac{1}{\sqrt{2}}(\ket{0000} + \ket{1010}),
  \end{equation}
  where the subscript \(A1\) denotes the state after Alice's first
  measurement.  For the second cell, Alice measures the observable
  \(Z \otimes I\), whose possible outcomes are
  \begin{equation}
    \operatorname{Out}((Z \otimes I)_{A} \otimes (I \otimes I)_{B}) =
    \begin{cases}
      +1 \left(\ketbra{0}{0} \otimes I \otimes I \otimes I\right)
        &\text{with probability } \frac{1}{2} \\
      -1 \left(\ketbra{1}{1} \otimes I \otimes I \otimes I\right)
        &\text{with probability } \frac{1}{2}.
    \end{cases}
  \end{equation}
  Suppose, now, that Alice has observed the outcome \(-1\). The state
  collapses to
  \begin{equation}
    \ket{\psi}_{A2} =  \ket{1010}.
  \end{equation}
  Finally, Alice measures the observable \(Z \otimes Z\), whose
  possible outcomes are
  \begin{equation}
    \operatorname{Out}((Z \otimes Z)_{A} \otimes (I \otimes I)_{B}) =
    \begin{cases}
      +1 \left(\left(\ketbra{00}{00} + \ketbra{11}{11}\right) \otimes I \otimes I\right)
      &\text{with probability } 0 \\
      -1 \left(\left(\ketbra{01}{01} + \ketbra{10}{10}\right) \otimes I \otimes I\right)
      &\text{with probability } 1.
    \end{cases}
  \end{equation}
  Notice that the only possible outcome that Alice can observe is
  \(-1\), and the state does not change, i.e.
  \(\ket{\psi}_{A3} = \ket{\psi}_{A2}\).  Alice, then, fills the first
  row with the values \(\{+1, -1, -1\}\), whose product is, as
  required, \(+1\). Upon receiving Alice's answer, Charlie goes to
  meet Bob. Suppose he assigns the second column to Bob. To fill in
  the value of the first cell (which is the intersection of the first
  row and second column), Bob measures the observable \(Z \otimes
  I\). The only possible outcome, considering the state
  \(\ket{\psi}_{A3}\), is \(-1\) ---~which matches Alice's answer~---
  and the state will not change again:
  \(\ket{\psi}_{B1} = \ket{\psi}_{A3}\). Moving on to the second cell,
  Bob measures the observable \(I \otimes X\), whose possible outcomes
  are
  \begin{equation}
    \operatorname{Out}((I \otimes I)_{A} \otimes (I \otimes X)_{B}) =
    \begin{cases}
      +1 \left(I \otimes I \otimes I \otimes \ketbra{+}{+}\right)
      &\text{with probability } \frac{1}{2} \\
      -1 \left(I \otimes I \otimes I \otimes \ketbra{-}{-}\right)
      &\text{with probability } \frac{1}{2}.
    \end{cases}
  \end{equation}
  Assume that Bob has observed the outcome \(+1\). Then, the state
  collapses to
  \begin{equation}
    \ket{\psi}_{B2} =  \frac{1}{\sqrt{2}}(\ket{1010} + \ket{1011}).
  \end{equation}
  Finally, Bob measures \(-Z \otimes X\) on his two qubits.
  The possible outcomes are
  \begin{equation}
    \operatorname{Out}((I \otimes I)_{A} \otimes (-Z \otimes X)_{B}) =
    \begin{cases}
      +1 \left(I \otimes I \otimes \left(\ketbra{1+}{1\!+\!} + \ketbra{0-}{0\!-\!}\right)\right)
      &\text{with prob. } 1 \\
      -1 \left(I \otimes I \otimes \left(\ketbra{1-}{1\!-\!} + \ketbra{0+}{0\!+\!}\right)\right)
      &\text{with prob. } 0.
    \end{cases}
  \end{equation}
  Bob will for sure observe the outcome \(+1\) and the state does not
 change, i.e.  \(\ket{\psi}_{B3} = \ket{\psi}_{B2}\). Therefore, Bob
  answers \(\{-1, +1, +1\}\). Alice's answer satisfies the property of
  the rows (that the product of the entries is equal to \(+1\)) and
  Bob's answer satisfies the property of the columns (product is equal
  to \(-1\)).  Moreover, Alice and Bob agreed in the intersection of
  the row and the column.  Hence, they won this round!
\end{tcbexample}

\subsection{Formal Proof}
To prove that the quantum solution indeed works, we must demonstrate
two fundamental properties. First, the product of the outcomes of the
three measurements on each row (equivalently, column) is equal to 1
(equiv. -1). Second, the outcome of Alice's measurements on the
intersection is always equal to the outcome of Bob's
measurement. Lemma~\ref{lem:product} formalizes the product property.

\begin{lemma}[The Product Property of the Quantum Solution]
  \label{lem:product}
  Let \(M_{i, j}\) be the observable at the cell \((i, j)\) of the
  \(3 \times 3\) grid shown in Figure~\ref{fig:quantum}. Then,
  it follows that

  \begin{align}
    \textit{for every }i, \prod_{j} \operatorname{Out}(M_{i, j}) &= +1  \textit{, and} \\
    \textit{for every }j, \prod_{i} \operatorname{Out}(M_{i, j}) &= -1.
  \end{align}
\end{lemma}

\begin{proof}
  \label{proof:product}
  First, notice that \(X^{2} = Z^{2} = Y^{2} = I\), \(XZ = \ci{}Y\)
  and \(ZX = -\ci{}Y\) (i.e. \(X\) and \(Z\) anticommute), and,
  similarly, \(XY = \ci{}Z\) and \(YX = -\ci{}Z\). Using these
  properties, we can see that the product of every row (equiv. column)
  is the identity \(I\) (equiv. \(-I\)), regardless of the order of
  the three observables.  That is, the three observables of every row
  and every column mutually commute (or, in other words, they are
  compatible).  Consequently, for every row and every column, it is
  possible to find a basis of eigenvectors that are common to the
  three observables, meaning that they can be diagonalized
  simultaneously. Tables~\ref{tab:eigenv-rows} and \ref{tab:eigenv-cols} show
  these common eigenvectors. Let \(M_{i, j}\) be the observables at
  each cell.  Then, for every row \(i\) (equiv. column \(j\)), we have
  \begin{align}
    M_{i, 0} M_{i, 1} M_{i, 2}
    &= (P_{i} \Lambda_{i, 0} P_{i}^{-1}) (P_{i}\Lambda_{i, 1}P_{i}^{-1}) (P_{i}\Lambda_{i, 2}P_{i}^{-1})
      \nonumber \\
    &= P_{i}(\Lambda_{i, 0} \Lambda_{i, 1} \Lambda_{i, 2})P_{i}^{-1} \nonumber \\
    &= P_{i}\Lambda_{i}P_{i}^{-1},
  \end{align}
  where \(P_{i}\) is the matrix whose columns are the common
  eigenvectors and \(\Lambda_{i}\) is the matrix whose diagonal is
  formed by the products of the eigenvalues of the observables,
  associated with the same eigenvector. What this essentially means is
  that any measurement \(M_{i, j}\) yields one of the eigenvalues
  \(\lambda\) in the diagonal of \(\Lambda_{i, j}\) and projects the
  state onto the \(\lambda\)-eigenspace. That is, it collapses the
  state to a linear combination of the two shared eigenvectors
  \(\ket{\lambda}_{1}\) and \(\ket{\lambda}_{2}\) in the
  \(\lambda\)-eigenspace. Then, the second measurement will collapse
  the state to either \(\ket{\lambda}_{1}\) or \(\ket{\lambda}_{2}\),
  eigenvectors common to the three observables.  Consequently, the
  third measurement will not change the state any further. Therefore,
  the product of the three outcomes will be the product of the
  eigenvalues associated with either \(\ket{\lambda}_{1}\) or
  \(\ket{\lambda}_{2}\), which is one of the entries in the diagonal
  of \(\Lambda_{i}\). But, notice that
  \(P_{i}\Lambda_{i}P_{i}^{-1} = I\); thus, \(\Lambda_{i} = I\) and
  the only possible value for the product is \(1\) (equivalently
  \(-1\) for columns). \qed
\end{proof}

\begin{table}[htbp]
  \centering
  \caption{Eigenvectors shared by the observables at each row of the quantum magic square.
    The eigenvectors were taken from~\ref{xxx}, adapting to the correct eigenvalues.}
  \label{tab:eigenv-rows}
  \begin{tabular}{c*{4}{>{\;\;}c}}
    \toprule
    & & Column 1 & Column 2 & Column 3 \\
    \midrule
    \multirow{2}{*}{Row 1} & \(+1\)
      & \ket{00}, \ket{10} & \ket{00}, \ket{01} & \ket{00}, \ket{11} \\
    & \(-1\)
      & \ket{01}, \ket{11} & \ket{10}, \ket{11} & \ket{01}, \ket{10} \\
    \midrule
    \multirow{4}{*}{Row 2} & \multirow{2}{*}{\(+1\)}
      & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} + \ket{10} + \ket{11})\),
                 & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} + \ket{10} + \ket{11})\),
                            & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} + \ket{10} + \ket{11})\), \\ 
    & & \((\nicefrac{1}{2}) (\ket{00} - \ket{01} + \ket{10} - \ket{11})\)\phantom{,} 
                 & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} - \ket{10} - \ket{11})\)\phantom{,} 
                            & \((\nicefrac{1}{2}) (\ket{00} - \ket{01} - \ket{10} + \ket{11})\)\phantom{,} \\[1.5mm]
    & \multirow{2}{*}{\(-1\)}
      & \((\nicefrac{1}{2}) (\ket{00} - \ket{01} - \ket{10} + \ket{11})\),
                 & \((\nicefrac{1}{2}) (\ket{00} - \ket{01} - \ket{10} + \ket{11})\),
                            & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} - \ket{10} - \ket{11})\), \\ 
    & & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} - \ket{10} - \ket{11})\)\phantom{,} 
                 & \((\nicefrac{1}{2}) (\ket{00} - \ket{01} + \ket{10} - \ket{11})\)\phantom{,} 
                            & \((\nicefrac{1}{2}) (\ket{00} - \ket{01} + \ket{10} - \ket{11})\)\phantom{,} \\
    \midrule
    \multirow{4}{*}{Row 3} & \multirow{2}{*}{\(+1\)}
      & \((\nicefrac{1}{2}) (\ket{01} - \ket{00} + \ket{10} + \ket{11})\),
                 & \((\nicefrac{1}{2}) (\ket{01} - \ket{00} + \ket{10} + \ket{11})\),
                            & \((\nicefrac{1}{2}) (\ket{01} - \ket{00} + \ket{10} + \ket{11})\), \\ 
    & & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} - \ket{10} + \ket{11})\),
                 & \((\nicefrac{1}{2}) (\ket{00} - \ket{01} + \ket{10} + \ket{11})\),
                            & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} + \ket{10} - \ket{11})\), \\[1.5mm]
    & \multirow{2}{*}{\(-1\)}
      & \((\nicefrac{1}{2}) (\ket{00} - \ket{01} + \ket{10} + \ket{11})\),
                 & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} - \ket{10} + \ket{11})\),
                            & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} - \ket{10} + \ket{11})\), \\
    & & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} + \ket{10} - \ket{11})\),
                 & \((\nicefrac{1}{2}) (\ket{00} + \ket{01} + \ket{10} - \ket{11})\),
                            & \((\nicefrac{1}{2}) (\ket{00} - \ket{01} + \ket{10} + \ket{11})\), \\
    \bottomrule
  \end{tabular}
\end{table}

\begin{table}[htbp]
  \centering
  \caption{Eigenvectors shared by the observables at each column of the quantum magic square.
    The eigenvectors were taken from~\ref{xxx}, adapting to the correct eigenvalues.}
  \label{tab:eigenv-cols}
  \begin{tabular}{c*{4}{>{\;\;}c}}
    \toprule
    & & Row 1 & Row 2 & Row 3 \\
    \midrule
    \multirow{4}{*}{Column 1} & \multirow{2}{*}{\(+1\)}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} + \ket{10})\),
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} + \ket{10})\), 
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{10})\), \\
    & &  \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{10})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} + \ket{11})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} + \ket{11})\)\phantom{,} \\[1.5mm]
    & \multirow{2}{*}{\(-1\)}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} + \ket{11})\), 
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{10})\), 
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} + \ket{10})\), \\
    & & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} - \ket{11})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} - \ket{11})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} - \ket{11})\)\phantom{,} \\
    \midrule
    \multirow{4}{*}{Column 2} & \multirow{2}{*}{\(+1\)}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} + \ket{01})\),
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} + \ket{01})\), 
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{01})\), \\
    & &  \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{01})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{10} + \ket{11})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{10} + \ket{11})\)\phantom{,} \\[1.5mm]
    & \multirow{2}{*}{\(-1\)}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{10} + \ket{11})\), 
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{01})\), 
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} + \ket{01})\), \\
    & & \((\nicefrac{1}{\sqrt{2}}) (\ket{10} - \ket{11})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{10} - \ket{11})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{10} - \ket{11})\)\phantom{,} \\
    \midrule
        \multirow{4}{*}{Column 3} & \multirow{2}{*}{\(+1\)}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} + \ket{11})\),
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} + \ket{11})\), 
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} + \ket{10})\), \\
    & &  \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{11})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} + \ket{10})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{11})\)\phantom{,} \\[1.5mm]
    & \multirow{2}{*}{\(-1\)}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} + \ket{10})\), 
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{11})\), 
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{00} + \ket{11})\), \\
    & & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} - \ket{10})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} - \ket{10})\)\phantom{,}
      & \((\nicefrac{1}{\sqrt{2}}) (\ket{01} - \ket{10})\)\phantom{,} \\
    \bottomrule
  \end{tabular}
\end{table}

Lemma~\ref{lem:product} shows that the quantum solution satisfies the
requirements of the game for every row and column. Now, we move on to
show that Alice and Bob always agree in the value that they assign
to the intersection of the row and column.

\begin{lemma}[The Intersection Property of the Quantum Solution]
  \label{lem:intersection}
  For any row \(i\) assigned to Alice and column \(j\) assigned to
  Bob, the value ascribed to the cell \((i, j)\) by Alice and Bob,
  after they have performed their measurements, is always the same.
\end{lemma}

\begin{proof}
  To prove that Alice and Bob agree at the intersection, it suffices
  to look to the eigenvectors shared by each set of mutually commuting
  operators, shown in Tables~\ref{tab:eigenv-rows} and
  \ref{tab:eigenv-cols}.  Notice that, regardless of the row assigned
  to Alice, the state of her subsystem after her measurements is
  always one of the eigenvectors in that row. This state is always a
  linear combination of one of Bob's eigenspaces for the cell in the
  intersection (the same applies if we consider first Bob than Alice).
  Take, for instance, the second row and first column. Suppose that
  Alice's measurements collapsed her qubits to
  \((\nicefrac{1}{2}) (\ket{00} - \ket{01} - \ket{10} + \ket{11})\).
  This state can be written as
  \((\nicefrac{1}{\sqrt{2}}) (\ket{00} - \ket{10}) -
  (\nicefrac{1}{\sqrt{2}}) (\ket{01} - \ket{11})\), a linear
  combination of the \(-1\)-eigenspace depicted in
  Table~\ref{tab:eigenv-cols} (column 1, row 2).  What is left is to
  show that Bob's state will be exactly the same as Alice's, implying
  that Bob shall observe the same result. This follows from the fact
  that the initial state is already symmetric (the first qubit of
  Alice is equal to the first qubit of Bob; the same is true for their
  second qubits) and the symmetry is preserved by any measurement
  performed by Alice and Bob. For the first row, it is easy to see.
  The others are trickier, but it all boils down to doing the
  calculations.  Consider, for instance, the second row, and suppose
  that the outcomes were \(-1\), \(-1\) and \(+1\), so that Alice's
  state collapsed to
  \((\nicefrac{1}{2}) (\ket{00} - \ket{01} - \ket{10} +
  \ket{11})\). The state after the first measurement is
  \begin{align}
    &\frac{1}{2\sqrt{2}} \Bigl(
    (\ket{00} - \ket{10}) \ket{00} +
    (\ket{01} - \ket{11}) \ket{01} +
    (\ket{10} - \ket{00}) \ket{10} +
    (\ket{11} - \ket{01}) \ket{11}
    \Bigr) \nonumber \\
    \equiv\;
    & \frac{1}{2\sqrt{2}} \Bigl(
      \ket{00} (\ket{00} - \ket{10}) +
      \ket{01} (\ket{01} - \ket{11}) +
      \ket{10} (\ket{10} - \ket{00}) +
      \ket{11} (\ket{11} - \ket{01})
    \Bigr).
  \end{align}
  And, the state after the three measurements is
  \begin{alignat}{2}
    &\frac{1}{4} \Bigl(
      &&(\ket{00} - \ket{01} - \ket{10} + \ket{11}) \ket{00} -
        (\ket{00} - \ket{01} - \ket{10} + \ket{11}) \ket{01} - \nonumber \\
    & &&(\ket{00} - \ket{01} - \ket{10} + \ket{11}) \ket{10} +
      (\ket{00} - \ket{01} - \ket{10} + \ket{11}) \ket{11}
    \Bigr) \nonumber \\
    \equiv\;
    & \frac{1}{4} \Bigl(
      &&\ket{00} (\ket{00} - \ket{01} - \ket{10} + \ket{11}) -
        \ket{01} (\ket{00} - \ket{01} - \ket{10} + \ket{11}) - \nonumber \\
    & &&\ket{10} (\ket{00} - \ket{01} - \ket{10} + \ket{11}) +
        \ket{11} (\ket{00} - \ket{01} - \ket{10} + \ket{11})
    \Bigr).
  \end{alignat}
  The calculations for the other rows and columns are similar, so we omitted them.
  \qed
\end{proof}
\section{Quantum Unitaries (? research)}
\label{sec:quantum-unitaries}

\section{Contextuality}
\label{sec:context}

\printbibliography{}
\end{document}
